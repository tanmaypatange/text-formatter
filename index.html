<!DOCTYPE html>
<html lang="en">
<!-- Previous head and styles remain exactly the same -->
<head>
    <meta charset="UTF-8">
    <title>Text Utility Tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
        }
        .container {
            display: flex;
            flex-direction: column;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }
        .text-section {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
        }
        .text-label {
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }
        textarea {
            width: 100%;
            resize: vertical;
            min-height: 200px;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            outline: none;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-family: monospace;
            line-height: 1.5;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        .counter {
            color: #666;
            font-size: 14px;
            margin-right: auto;
        }
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            background-color: #2196F3;
            color: white;
            font-size: 14px;
        }
        .btn:hover:not(.btn-disabled) {
            background-color: #1E88E5;
        }
        .btn-disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.6;
        }
        .btn-secondary {
            background-color: #4CAF50;
        }
        .btn-secondary:hover {
            background-color: #45a049;
        }
        .confirmation {
            margin-left: 10px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .confirmation-success {
            color: #4CAF50;
        }
        .confirmation-error {
            color: red;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="text-section">
            <div class="text-label">Input Your Text</div>
            <textarea id="inputTextArea" placeholder="Paste your text here." spellcheck="false"></textarea>
            <div class="action-buttons">
                <div class="counter" id="inputCounter">Characters: 0 | Words: 0</div>
                <button id="clearButton" class="btn">Clear Text</button>
            </div>
        </div>

        <div class="text-section">
            <div class="text-label">Output Text</div>
            <textarea id="outputTextArea" readonly placeholder="Input text will appear here automatically." spellcheck="false"></textarea>
            <div class="action-buttons">
                <div class="counter" id="outputCounter">Characters: 0 | Words: 0</div>
                <button id="copyOutputButton" class="btn btn-disabled" disabled>Copy Text</button>
                <button id="revertButton" class="btn btn-secondary btn-disabled" disabled>Revert</button>
                <button id="removeContractionsButton" class="btn btn-secondary btn-disabled" disabled>Remove Contractions</button>
                <button id="addContractionsButton" class="btn btn-secondary btn-disabled" disabled>Add Contractions</button>
                <span id="outputCopyConfirmation" class="confirmation confirmation-success"></span>
                <span id="processConfirmation" class="confirmation confirmation-success"></span>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const inputTextArea = document.getElementById('inputTextArea');
        const outputTextArea = document.getElementById('outputTextArea');
        const inputCounter = document.getElementById('inputCounter');
        const outputCounter = document.getElementById('outputCounter');
        const clearButton = document.getElementById('clearButton');
        const copyOutputButton = document.getElementById('copyOutputButton');
        const revertButton = document.getElementById('revertButton');
        const removeContractionsButton = document.getElementById('removeContractionsButton');
        const addContractionsButton = document.getElementById('addContractionsButton');
        const outputCopyConfirmation = document.getElementById('outputCopyConfirmation');
        const processConfirmation = document.getElementById('processConfirmation');

        // Contractions mapping
        const contractions = {
            // Standard negative contractions
            "are not": "aren't", "cannot": "can't", "could not": "couldn't",
            "did not": "didn't", "does not": "doesn't", "do not": "don't",
            "had not": "hadn't", "has not": "hasn't", "have not": "haven't",
            "is not": "isn't", "must not": "mustn't", "should not": "shouldn't",
            "was not": "wasn't", "were not": "weren't", "will not": "won't",
            "would not": "wouldn't",
            
            // Personal pronouns + auxiliary verbs
            "he would": "he'd", "he will": "he'll", "he is": "he's", "he has": "he's",
            "i would": "i'd", "i will": "i'll", "i am": "i'm", "i have": "i've",
            "she would": "she'd", "she will": "she'll", "she is": "she's", "she has": "she's",
            "they would": "they'd", "they will": "they'll", "they are": "they're", "they have": "they've",
            "we would": "we'd", "we will": "we'll", "we are": "we're", "we have": "we've",
            "you would": "you'd", "you will": "you'll", "you are": "you're", "you have": "you've",
            "who would": "who'd", "who will": "who'll", "who are": "who're", "who is": "who's", "who have": "who've",
            
            // Question words + auxiliary verbs
            "what is": "what's", "what are": "what're", "what will": "what'll", "what have": "what've",
            "when is": "when's", "when are": "when're", "when will": "when'll", "when have": "when've",
            "where is": "where's", "where are": "where're", "where will": "where'll", "where have": "where've",
            "why is": "why's", "why are": "why're", "why will": "why'll", "why have": "why've",
            "how is": "how's", "how are": "how're", "how will": "how'll", "how have": "how've",
            
            // Demonstratives + auxiliary verbs
            "that is": "that's", "that will": "that'll", "that have": "that've",
            "there is": "there's", "there will": "there'll", "there have": "there've",
            "this is": "this's", "this will": "this'll", "this have": "this've",
            
            // Time and date related
            "today is": "today's", "tomorrow is": "tomorrow's", "yesterday was": "yesterday's",
            "next week is": "next week's", "last week was": "last week's",
            "month is": "month's", "year is": "year's", "week is": "week's",
            "morning is": "morning's", "evening is": "evening's", "night is": "night's",
            
            // Common phrases
            "let us": "let's", "might have": "might've", "must have": "must've",
            "should have": "should've", "would have": "would've", "could have": "could've",
            
            // Possessives (common nouns)
            "world is": "world's", "country is": "country's", "city is": "city's",
            "person is": "person's", "people are": "people're", "man is": "man's",
            "woman is": "woman's", "child is": "child's", "dog is": "dog's",
            "cat is": "cat's", "house is": "house's", "car is": "car's",
            "weather is": "weather's", "day is": "day's", "time is": "time's"
        };

        // Core functions
        function syncText() {
            outputTextArea.value = inputTextArea.value;
            updateCounters();
            updateButtons();
        }

        function updateCounters() {
            updateCounter(inputTextArea, inputCounter);
            updateCounter(outputTextArea, outputCounter);
        }

        function updateCounter(textArea, counterElement) {
            const text = textArea.value;
            const charCount = text.length;
            const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
            counterElement.textContent = `Characters: ${charCount} | Words: ${wordCount}`;
        }

        function updateButtons() {
            const hasOutput = outputTextArea.value.trim() !== '';
            const isDifferent = inputTextArea.value !== outputTextArea.value;
            
            copyOutputButton.disabled = !hasOutput;
            copyOutputButton.classList.toggle('btn-disabled', !hasOutput);
            
            revertButton.disabled = !isDifferent;
            revertButton.classList.toggle('btn-disabled', !isDifferent);

            removeContractionsButton.disabled = !hasOutput;
            removeContractionsButton.classList.toggle('btn-disabled', !hasOutput);

            addContractionsButton.disabled = !hasOutput;
            addContractionsButton.classList.toggle('btn-disabled', !hasOutput);
        }

        function showConfirmation(element, message, isError = false) {
            element.textContent = message;
            element.style.opacity = '1';
            element.classList.toggle('confirmation-error', isError);
            element.classList.toggle('confirmation-success', !isError);
            setTimeout(() => {
                element.style.opacity = '0';
            }, 2000);
        }

        // Contractions functions
        function removeContractions(text) {
            return text.replace(/\b(can't|won't|ain't|\w+n't|\w+'(?:m|s|ve|re|ll|d))\b/gi, match => {
                const lowerMatch = match.toLowerCase();
                const replacement = Object.keys(contractions).find(key => 
                    contractions[key].toLowerCase() === lowerMatch
                );
                return replacement ? 
                    (match[0] === match[0].toUpperCase() 
                        ? replacement[0].toUpperCase() + replacement.slice(1)
                        : replacement) : 
                    match;
            });
        }

        function addContractions(text) {
            let processedText = text;
            Object.entries(contractions).forEach(([expanded, contracted]) => {
                const regex = new RegExp(`\\b${expanded}\\b`, 'gi');
                processedText = processedText.replace(regex, match => 
                    match[0] === match[0].toUpperCase() 
                        ? contracted[0].toUpperCase() + contracted.slice(1)
                        : contracted
                );
            });
            return processedText;
        }

        // Event Listeners
        inputTextArea.addEventListener('input', syncText);

        clearButton.addEventListener('click', () => {
            inputTextArea.value = '';
            syncText();
        });

        copyOutputButton.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(outputTextArea.value);
                showConfirmation(outputCopyConfirmation, 'Copied!');
            } catch {
                showConfirmation(outputCopyConfirmation, 'Failed to copy', true);
            }
        });

        revertButton.addEventListener('click', () => {
            outputTextArea.value = inputTextArea.value;
            updateCounters();
            updateButtons();
            showConfirmation(processConfirmation, 'Reverted!');
        });

        removeContractionsButton.addEventListener('click', () => {
            outputTextArea.value = removeContractions(outputTextArea.value);
            updateCounters();
            updateButtons();
            showConfirmation(processConfirmation, 'Contractions Removed!');
        });

        addContractionsButton.addEventListener('click', () => {
            outputTextArea.value = addContractions(outputTextArea.value);
            updateCounters();
            updateButtons();
            showConfirmation(processConfirmation, 'Contractions Added!');
        });

        // Initialize
        syncText();
    </script>
</body>
</html>
